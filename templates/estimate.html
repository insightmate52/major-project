{% extends "base.html" %}
{% block content %}

<div class="card-box">
  <div class="page-title">ðŸ“ˆ Future Value Estimation</div>
  <div class="page-subtitle">
    Estimate future values based on historical patterns in your dataset
  </div>

  <!-- TARGET -->
  <label class="fw-semibold mb-1">Target Variable</label>
  <select id="targetCol" class="form-select mb-3">
    {% for col in dataset_summary.columns %}
      <option value="{{ col }}">{{ col }}</option>
    {% endfor %}
  </select>

  <!-- TRAIN -->
  <button class="btn btn-warning-custom w-100 mb-4" onclick="trainModel()">
    ðŸ§  Train Estimation Model
  </button>

  <!-- HORIZON -->
  <label class="fw-semibold mb-1">Prediction Window</label>
  <input id="horizon" type="number" value="3" min="1" class="form-control mb-2">
  <div class="text-muted small mb-3">
    Example: 3 = summarize next 3 future values
  </div>

  <!-- RUN -->
  <button class="btn btn-success-custom w-100" onclick="runEstimation()">
    â–¶ Run Estimation
  </button>
</div>

<div class="card-box">
  <div class="page-title">ðŸ“Š Estimation Result</div>
  <pre id="forecastOutput" class="mt-3">
Train the model and run estimation to see results here.
  </pre>
</div>

<script>
async function trainModel() {
  const target = document.getElementById("targetCol").value;
  const res = await fetch("/train_forecast", {
    method: "POST",
    headers: {"Content-Type": "application/json"},
    body: JSON.stringify({ target })
  });
  const data = await res.json();
  alert(data.status || data.error);
}

async function runEstimation() {
  const horizon = Number(document.getElementById("horizon").value);
  const res = await fetch("/forecast", {
    method: "POST",
    headers: {"Content-Type": "application/json"},
    body: JSON.stringify({ horizon })
  });
  const data = await res.json();
  document.getElementById("forecastOutput").textContent =
    JSON.stringify(data, null, 2);
}
</script>

{% endblock %}




